"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[169],{3905:function(t,e,l){l.d(e,{Zo:function(){return p},kt:function(){return d}});var n=l(7294);function a(t,e,l){return e in t?Object.defineProperty(t,e,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[e]=l,t}function r(t,e){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),l.push.apply(l,n)}return l}function i(t){for(var e=1;e<arguments.length;e++){var l=null!=arguments[e]?arguments[e]:{};e%2?r(Object(l),!0).forEach((function(e){a(t,e,l[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):r(Object(l)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(l,e))}))}return t}function s(t,e){if(null==t)return{};var l,n,a=function(t,e){if(null==t)return{};var l,n,a={},r=Object.keys(t);for(n=0;n<r.length;n++)l=r[n],e.indexOf(l)>=0||(a[l]=t[l]);return a}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)l=r[n],e.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(t,l)&&(a[l]=t[l])}return a}var o=n.createContext({}),u=function(t){var e=n.useContext(o),l=e;return t&&(l="function"==typeof t?t(e):i(i({},e),t)),l},p=function(t){var e=u(t.components);return n.createElement(o.Provider,{value:e},t.children)},k={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},h=n.forwardRef((function(t,e){var l=t.components,a=t.mdxType,r=t.originalType,o=t.parentName,p=s(t,["components","mdxType","originalType","parentName"]),h=u(l),d=a,c=h["".concat(o,".").concat(d)]||h[d]||k[d]||r;return l?n.createElement(c,i(i({ref:e},p),{},{components:l})):n.createElement(c,i({ref:e},p))}));function d(t,e){var l=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var r=l.length,i=new Array(r);i[0]=h;var s={};for(var o in e)hasOwnProperty.call(e,o)&&(s[o]=e[o]);s.originalType=t,s.mdxType="string"==typeof t?t:a,i[1]=s;for(var u=2;u<r;u++)i[u]=l[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,l)}h.displayName="MDXCreateElement"},415:function(t,e,l){l.r(e),l.d(e,{assets:function(){return o},contentTitle:function(){return i},default:function(){return k},frontMatter:function(){return r},metadata:function(){return s},toc:function(){return u}});var n=l(3117),a=(l(7294),l(3905));const r={},i="Analyze algorithm stability",s={unversionedId:"recipes/algorithm-stability",id:"recipes/algorithm-stability",title:"Analyze algorithm stability",description:"For many applications, it is very important the algorithms that are used are stable enough. This means, that when a different sample of data is taken from some distribution, the results will turn out similar. This, combined with possible inherent stochastic properties of an algorithm, make up for the stability of the algorithm. The same applies to Feature Selection or Feature Ranking algorithms.",source:"@site/docs/recipes/algorithm-stability.md",sourceDirName:"recipes",slug:"/recipes/algorithm-stability",permalink:"/fseval/docs/recipes/algorithm-stability",draft:!1,editUrl:"https://github.com/dunnkers/fseval/tree/website/docs/recipes/algorithm-stability.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"fseval.types.Task",permalink:"/fseval/docs/types/Task"},next:{title:"Running on AWS",permalink:"/fseval/docs/recipes/running-on-aws"}},o={},u=[{value:"The experiment",id:"the-experiment",level:2},{value:"Analyzing the results",id:"analyzing-the-results",level:2},{value:"Recap",id:"recap",level:3},{value:"Analysis",id:"analysis",level:3}],p={toc:u};function k(t){let{components:e,...r}=t;return(0,a.kt)("wrapper",(0,n.Z)({},p,r,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"analyze-algorithm-stability"},"Analyze algorithm stability"),(0,a.kt)("p",null,"For many applications, it is very important the algorithms that are used are ",(0,a.kt)("strong",{parentName:"p"},"stable")," enough. This means, that when a different sample of data is taken from some distribution, the results will turn out similar. This, combined with possible inherent stochastic properties of an algorithm, make up for the ",(0,a.kt)("em",{parentName:"p"},"stability")," of the algorithm. The same applies to Feature Selection or Feature Ranking algorithms."),(0,a.kt)("p",null,"Therefore, let's do such an experiment! We are going to compare the stability of ",(0,a.kt)("a",{parentName:"p",href:"https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.56.4740&rep=rep1&type=pdf"},"ReliefF")," to ",(0,a.kt)("a",{parentName:"p",href:"https://www.jstatsoft.org/article/view/v036i11"},"Boruta"),", two popular feature selection algorithms. We are going to do this using a metric introduced in ",(0,a.kt)("a",{parentName:"p",href:"https://www.jmlr.org/papers/volume18/17-514/17-514.pdf"},"Nogueira et al, 2018"),"."),(0,a.kt)("h2",{id:"the-experiment"},"The experiment"),(0,a.kt)("p",null,"We are going to run an experiment with the following ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/dunnkers/fseval/tree/master/examples/algorithm-stability-yaml/"},"configuration"),". Download the experiment config: ",(0,a.kt)("a",{parentName:"p",href:"pathname:///fseval/zipped-examples/algorithm-stability-yaml.zip"},"algorithm-stability-yaml.zip"),"."),(0,a.kt)("p",null,"Most notably are the following configuration settings:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="my_config.yaml"',title:'"my_config.yaml"'},"defaults:\n  - base_pipeline_config\n  - _self_\n  - override dataset: synclf_hard\n  - override validator: knn\n  - override /callbacks:\n      - to_sql\n  // highlight-start\n  - override /metrics:\n      - stability_nogueira\n  // highlight-end\n\n// highlight-start\nn_bootstraps: 10\n// highlight-end\n")),(0,a.kt)("p",null,"That means, we are going to generate a synthetic dataset and sample 10 subsets from it. This is because ",(0,a.kt)("inlineCode",{parentName:"p"},"n_bootstraps=10"),". Then, after the feature selection algorithm was executed and fitted on the dataset, a custom installed metric will be executed, called ",(0,a.kt)("inlineCode",{parentName:"p"},"stability_nogueira"),". This can be found in the ",(0,a.kt)("inlineCode",{parentName:"p"},"/conf/metrics")," folder, which in turn refers to a class in the ",(0,a.kt)("inlineCode",{parentName:"p"},"benchmark.py")," file."),(0,a.kt)("p",null,"To now run the experiment, run the following command inside the ",(0,a.kt)("inlineCode",{parentName:"p"},"algorithm-stability-yaml")," folder:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'python benchmark.py --multirun ranker="glob(*)" +callbacks.to_sql.url="sqlite:///$HOME/results.sqlite"\n')),(0,a.kt)("h2",{id:"analyzing-the-results"},"Analyzing the results"),(0,a.kt)("h3",{id:"recap"},"Recap"),(0,a.kt)("p",null,"Hi! Let's analyze the results of the experiment you just ran. To ",(0,a.kt)("strong",{parentName:"p"},"recap"),":"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"You just ran something similar to:"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"p"},'python benchmark.py --multirun ranker="glob(*)" +callbacks.to_sql.url="sqlite:///$HOME/results.sqlite"'))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"There now should exist a ",(0,a.kt)("inlineCode",{parentName:"p"},".sqlite")," file at this path: ",(0,a.kt)("inlineCode",{parentName:"p"},"$HOME/results.sqlite"),":"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"$ ls -al $HOME/results.sqlite\n-rw-r--r-- 1 vscode vscode 20480 Sep 21 08:16 /home/vscode/results.sqlite\n")))),(0,a.kt)("p",null,"Let's now analyze the results! \ud83d\udcc8"),(0,a.kt)("h3",{id:"analysis"},"Analysis"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"The rest of the text assumes all code was ran inside a Jupyter Notebook, in chronological order. The source Notebook can be found ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/dunnkers/fseval/tree/master/examples/algorithm-stability-yaml/analyze-results.ipynb"},"here"))),(0,a.kt)("p",null,"First, we will install ",(0,a.kt)("inlineCode",{parentName:"p"},"plotly-express"),", so we can make nice plots later."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"%pip install plotly-express --quiet\n")),(0,a.kt)("p",null,"Figure out the SQL connection URI."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'import os\n\ncon: str = "sqlite:///" + os.environ["HOME"] + "/results.sqlite"\ncon\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"'sqlite:////home/vscode/results.sqlite'\n")),(0,a.kt)("p",null,"Read in the ",(0,a.kt)("inlineCode",{parentName:"p"},"experiments")," table. This table contains metadata for all 'experiments' that have been run."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'import pandas as pd\n\nexperiments: pd.DataFrame = pd.read_sql_table("experiments", con=con, index_col="id")\nexperiments\n')),(0,a.kt)("div",null,(0,a.kt)("table",{border:"1",class:"dataframe"},(0,a.kt)("thead",null,(0,a.kt)("tr",null,(0,a.kt)("th",null),(0,a.kt)("th",null,"dataset"),(0,a.kt)("th",null,"dataset/n"),(0,a.kt)("th",null,"dataset/p"),(0,a.kt)("th",null,"dataset/task"),(0,a.kt)("th",null,"dataset/group"),(0,a.kt)("th",null,"dataset/domain"),(0,a.kt)("th",null,"ranker"),(0,a.kt)("th",null,"validator"),(0,a.kt)("th",null,"local_dir"),(0,a.kt)("th",null,"date_created")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"id"),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null))),(0,a.kt)("tbody",null,(0,a.kt)("tr",null,(0,a.kt)("th",null,"38vqcwus"),(0,a.kt)("td",null,"Synclf hard"),(0,a.kt)("td",null,"10000"),(0,a.kt)("td",null,"50"),(0,a.kt)("td",null,"classification"),(0,a.kt)("td",null,"Synclf"),(0,a.kt)("td",null,"synthetic"),(0,a.kt)("td",null,"Boruta"),(0,a.kt)("td",null,"k-NN"),(0,a.kt)("td",null,"/workspaces/fseval/examples/algorithm-stabilit..."),(0,a.kt)("td",null,"2022-09-21 08:22:28.965510")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"y6bb1hcc"),(0,a.kt)("td",null,"Synclf hard"),(0,a.kt)("td",null,"1000"),(0,a.kt)("td",null,"50"),(0,a.kt)("td",null,"classification"),(0,a.kt)("td",null,"Synclf"),(0,a.kt)("td",null,"synthetic"),(0,a.kt)("td",null,"Boruta"),(0,a.kt)("td",null,"k-NN"),(0,a.kt)("td",null,"/workspaces/fseval/examples/algorithm-stabilit..."),(0,a.kt)("td",null,"2022-09-21 08:22:53.609396")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"3vtr13pg"),(0,a.kt)("td",null,"Synclf hard"),(0,a.kt)("td",null,"1000"),(0,a.kt)("td",null,"50"),(0,a.kt)("td",null,"classification"),(0,a.kt)("td",null,"Synclf"),(0,a.kt)("td",null,"synthetic"),(0,a.kt)("td",null,"ReliefF"),(0,a.kt)("td",null,"k-NN"),(0,a.kt)("td",null,"/workspaces/fseval/examples/algorithm-stabilit..."),(0,a.kt)("td",null,"2022-09-21 08:25:09.974370"))))),(0,a.kt)("p",null,"That's looking good \ud83d\ude4c\ud83c\udffb."),(0,a.kt)("p",null,"Now, let's read in the ",(0,a.kt)("inlineCode",{parentName:"p"},"stability")," table. We put data in this table by using our custom-made metric, defined in the ",(0,a.kt)("inlineCode",{parentName:"p"},"StabilityNogueira")," class in ",(0,a.kt)("inlineCode",{parentName:"p"},"benchmark.py"),". There, we push data to this table using ",(0,a.kt)("inlineCode",{parentName:"p"},"callbacks.on_table"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'stability: pd.DataFrame = pd.read_sql_table("stability", con=con, index_col="id")\nstability\n')),(0,a.kt)("div",null,(0,a.kt)("table",{border:"1",class:"dataframe"},(0,a.kt)("thead",null,(0,a.kt)("tr",null,(0,a.kt)("th",null),(0,a.kt)("th",null,"index"),(0,a.kt)("th",null,"stability")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"id"),(0,a.kt)("th",null),(0,a.kt)("th",null))),(0,a.kt)("tbody",null,(0,a.kt)("tr",null,(0,a.kt)("th",null,"y6bb1hcc"),(0,a.kt)("td",null,"0"),(0,a.kt)("td",null,"0.933546")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"3vtr13pg"),(0,a.kt)("td",null,"0"),(0,a.kt)("td",null,"1.000000"))))),(0,a.kt)("p",null,"Cool. Now let's join the experiments with their actual metrics."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"stability_experiments = stability.join(experiments)\nstability_experiments\n")),(0,a.kt)("div",null,(0,a.kt)("table",{border:"1",class:"dataframe"},(0,a.kt)("thead",null,(0,a.kt)("tr",null,(0,a.kt)("th",null),(0,a.kt)("th",null,"index"),(0,a.kt)("th",null,"stability"),(0,a.kt)("th",null,"dataset"),(0,a.kt)("th",null,"dataset/n"),(0,a.kt)("th",null,"dataset/p"),(0,a.kt)("th",null,"dataset/task"),(0,a.kt)("th",null,"dataset/group"),(0,a.kt)("th",null,"dataset/domain"),(0,a.kt)("th",null,"ranker"),(0,a.kt)("th",null,"validator"),(0,a.kt)("th",null,"local_dir"),(0,a.kt)("th",null,"date_created")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"id"),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null),(0,a.kt)("th",null))),(0,a.kt)("tbody",null,(0,a.kt)("tr",null,(0,a.kt)("th",null,"y6bb1hcc"),(0,a.kt)("td",null,"0"),(0,a.kt)("td",null,"0.933546"),(0,a.kt)("td",null,"Synclf hard"),(0,a.kt)("td",null,"1000"),(0,a.kt)("td",null,"50"),(0,a.kt)("td",null,"classification"),(0,a.kt)("td",null,"Synclf"),(0,a.kt)("td",null,"synthetic"),(0,a.kt)("td",null,"Boruta"),(0,a.kt)("td",null,"k-NN"),(0,a.kt)("td",null,"/workspaces/fseval/examples/algorithm-stabilit..."),(0,a.kt)("td",null,"2022-09-21 08:22:53.609396")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"3vtr13pg"),(0,a.kt)("td",null,"0"),(0,a.kt)("td",null,"1.000000"),(0,a.kt)("td",null,"Synclf hard"),(0,a.kt)("td",null,"1000"),(0,a.kt)("td",null,"50"),(0,a.kt)("td",null,"classification"),(0,a.kt)("td",null,"Synclf"),(0,a.kt)("td",null,"synthetic"),(0,a.kt)("td",null,"ReliefF"),(0,a.kt)("td",null,"k-NN"),(0,a.kt)("td",null,"/workspaces/fseval/examples/algorithm-stabilit..."),(0,a.kt)("td",null,"2022-09-21 08:25:09.974370"))))),(0,a.kt)("p",null,"Finally, we can plot the results so we can get a better grasp of what's going on:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'import plotly.express as px\n\npx.bar(stability_experiments,\n    x="ranker",\n    y="stability"\n)\n')),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"feature selectors algorithm stability",src:l(8655).Z,width:"879",height:"450"})),(0,a.kt)("p",null,"We can now observe that for Boruta and ReliefF, ReliefF is the most 'stable' given this dataset, getting 100% the same features for all 10 bootstraps that were run."))}k.isMDXComponent=!0},8655:function(t,e,l){e.Z=l.p+"assets/images/feature-selectors-stability-barplot-daac147ba94e5d74bc6c4265a3050ff0.png"}}]);